import streamlit as st

# μ•½λ¬Ό λ°μ΄ν„°λ² μ΄μ¤ μμ‹
medicine_db = {
    "μƒλ¦¬ν†µ": [
        {"μ΄λ¦„": "μ΄λ¶€νμ •", "ν•νƒ": "μ •μ  λ° μΊ΅μν•", "μ„±λ¶„": ["μ΄λ¶€ν”„λ΅ν"]},
        {"μ΄λ¦„": "νƒ€μ΄λ λ†€μ •", "ν•νƒ": "μ •μ  λ° μΊ΅μν•", "μ„±λ¶„": ["μ•„μ„ΈνΈμ•„λ―Έλ…Έν"]},
        {"μ΄λ¦„": "μ• λ‹νμ‹λ½", "ν•νƒ": "μ•΅μƒν•", "μ„±λ¶„": ["λ±μ‹λ¶€ν”„λ΅ν"]}
    ],
    "λ³µν†µ": [
        {"μ΄λ¦„": "ν›Όμ¤νƒν”λ¬μ¤μ •", "ν•νƒ": "μ •μ  λ° μΊ΅μν•", "μ„±λ¶„": ["μ†ν™”ν¨μ†", "λ¦¬νμ "]},
        {"μ΄λ¦„": "κΉμ¤ν™λ…μμ•΅", "ν•νƒ": "μ•΅μƒν•", "μ„±λ¶„": ["μƒμ•½"]},
        {"μ΄λ¦„": "λ‹¤μ μ¤μΊ΅μ", "ν•νƒ": "μ •μ  λ° μΊ΅μν•", "μ„±λ¶„": ["μ†ν™”ν¨μ†"]}
    ],
    "λ‘ν†µ": [
        {"μ΄λ¦„": "μ΄μ§€μ—”6μ—μ΄μ¤μ •", "ν•νƒ": "μ •μ  λ° μΊ΅μν•", "μ„±λ¶„": ["μ•„μ„ΈνΈμ•„λ―Έλ…Έν"]},
        {"μ΄λ¦„": "νƒ€μ΄λ λ†€μ‹λ½", "ν•νƒ": "μ•΅μƒν•", "μ„±λ¶„": ["μ•„μ„ΈνΈμ•„λ―Έλ…Έν"]},
        {"μ΄λ¦„": "μ†μ½νμ •", "ν•νƒ": "μ •μ  λ° μΊ΅μν•", "μ„±λ¶„": ["μ΄λ¶€ν”„λ΅ν", "μΉ΄νμΈ"]}
    ],
    "κ·Όμ΅ν†µ": [
        {"μ΄λ¦„": "νμνμ •", "ν•νƒ": "μ •μ  λ° μΊ΅μν•", "μ„±λ¶„": ["μ΄λ¶€ν”„λ΅ν", "μΉ΄νμΈ"]},
        {"μ΄λ¦„": "νƒ€μ΄λ λ†€μ‹λ½", "ν•νƒ": "μ•΅μƒν•", "μ„±λ¶„": ["μ•„μ„ΈνΈμ•„λ―Έλ…Έν"]},
        {"μ΄λ¦„": "λ¶€λ£¨νμ •", "ν•νƒ": "μ •μ  λ° μΊ΅μν•", "μ„±λ¶„": ["μ΄λ¶€ν”„λ΅ν"]}
    ],
    "κ΄€μ ν†µ": [
        {"μ΄λ¦„": "νƒ€μ„Έλ†€μ •", "ν•νƒ": "μ •μ  λ° μΊ΅μν•", "μ„±λ¶„": ["μ•„μ„ΈνΈμ•„λ―Έλ…Έν"]},
        {"μ΄λ¦„": "μ„Έν† νμ‹λ½", "ν•νƒ": "μ•΅μƒν•", "μ„±λ¶„": ["μ•„μ„ΈνΈμ•„λ―Έλ…Έν"]},
        {"μ΄λ¦„": "λ¶€λ£¨νμ‹λ½", "ν•νƒ": "μ•΅μƒν•", "μ„±λ¶„": ["μ΄λ¶€ν”„λ΅ν"]}
    ],
    "μΉν†µ": [
        {"μ΄λ¦„": "νƒ€μ΄λ λ†€μ •", "ν•νƒ": "μ •μ  λ° μΊ΅μν•", "μ„±λ¶„": ["μ•„μ„ΈνΈμ•„λ―Έλ…Έν"]},
        {"μ΄λ¦„": "λ§¥μ‹λ¶€νμ‹λ½", "ν•νƒ": "μ•΅μƒν•", "μ„±λ¶„": ["λ±μ‹λ¶€ν”„λ΅ν"]},
        {"μ΄λ¦„": "κ²λ³΄λ¦°μ •", "ν•νƒ": "μ •μ  λ° μΊ΅μν•", "μ„±λ¶„": ["μ΄λ¶€ν”„λ΅ν", "μΉ΄νμΈ"]}
    ]
}
avoid_ingredients = {
    "μ•λ λ¥΄κΈ°": ["μΉ΄νμΈ", "μ΄λ¶€ν”„λ΅ν"],
    "μ²μ‹": ["μ΄λ¶€ν”„λ΅ν"],
    "μ΅Έμ": ["ν•­νμ¤νƒ€λ―Ό", "μΉ΄νμΈ"],
    "μ„μ¥ μ¥μ• ": ["μ΄λ¶€ν”„λ΅ν"],
    "κ³µλ³µ": ["μ΄λ¶€ν”„λ΅ν"]
}

def main():
    st.title("π’Medicine Recommender")

    symptom = st.selectbox("1. μ¦μƒμ„ μ„ νƒν•μ„Έμ”:", list(medicine_db.keys()))
    selected_criteria = st.multiselect("2. κ³ λ ¤μ‚¬ν•­μ„ μ„ νƒν•μ„Έμ”:", list(avoid_ingredients.keys()))
    form = st.radio("3. μ•½ ν•νƒλ¥Ό μ„ νƒν•μ„Έμ”:", ["μ •μ  λ° μΊ΅μν•", "μ•΅μƒν•"])

    avoid_set = set()
    for c in selected_criteria:
        avoid_set.update(avoid_ingredients.get(c, []))

    st.markdown(f"### π« ν”Όν•΄μ•Ό ν•  μ„±λ¶„: {', '.join(avoid_set) if avoid_set else 'μ—†μ'}")

    candidates = medicine_db.get(symptom, [])
    recommended = []
    for med in candidates:
        if med["ν•νƒ"] == form and not any(ingredient in avoid_set for ingredient in med["μ„±λ¶„"]):
            recommended.append(med["μ΄λ¦„"])

    if recommended:
        st.markdown("### β… μ¶”μ² μ•½λ¬Ό:")
        for name in recommended:
            st.write(f"- {name}")
    else:
        st.warning("μ΅°κ±΄μ— λ§λ” μ•½λ¬Όμ΄ μ—†μµλ‹λ‹¤. μ•½μ‚¬μ™€ μƒλ‹΄μ„ κ¶μ¥ν•©λ‹λ‹¤.")

if __name__ == "__main__":
    main()
