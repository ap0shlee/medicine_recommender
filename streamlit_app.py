import streamlit as st

# ì•½ë¬¼ ë°ì´í„°ë² ì´ìŠ¤ ì˜ˆì‹œ
medicine_db = {
    "ìƒë¦¬í†µ": [
        {"ì´ë¦„": "ì´ë¶€íŽœì •", "í˜•íƒœ": "ì •ì œ ë° ìº¡ìŠí˜•", "ì„±ë¶„": ["ì´ë¶€í”„ë¡œíŽœ"]},
        {"ì´ë¦„": "íƒ€ì´ë ˆë†€ì •", "í˜•íƒœ": "ì •ì œ ë° ìº¡ìŠí˜•", "ì„±ë¶„": ["ì•„ì„¸íŠ¸ì•„ë¯¸ë…¸íŽœ"]},
        {"ì´ë¦„": "ì• ë‹ˆíŽœì‹œëŸ½", "í˜•íƒœ": "ì•¡ìƒí˜•", "ì„±ë¶„": ["ë±ì‹œë¶€í”„ë¡œíŽœ"]}
    ],
    "ë³µí†µ": [
        {"ì´ë¦„": "í›¼ìŠ¤íƒˆí”ŒëŸ¬ìŠ¤ì •", "í˜•íƒœ": "ì •ì œ ë° ìº¡ìŠí˜•", "ì„±ë¶„": ["ì†Œí™”íš¨ì†Œ", "ë¦¬íŒŒì œ"]},
        {"ì´ë¦„": "ê¹ŒìŠ¤í™œëª…ìˆ˜ì•¡", "í˜•íƒœ": "ì•¡ìƒí˜•", "ì„±ë¶„": ["ìƒì•½"]},
        {"ì´ë¦„": "ë‹¤ì œìŠ¤ìº¡ìŠ", "í˜•íƒœ": "ì •ì œ ë° ìº¡ìŠí˜•", "ì„±ë¶„": ["ì†Œí™”íš¨ì†Œ"]}
    ],
    "ë‘í†µ": [
        {"ì´ë¦„": "ì´ì§€ì—”6ì—ì´ìŠ¤ì •", "í˜•íƒœ": "ì •ì œ ë° ìº¡ìŠí˜•", "ì„±ë¶„": ["ì•„ì„¸íŠ¸ì•„ë¯¸ë…¸íŽœ"]},
        {"ì´ë¦„": "íƒ€ì´ë ˆë†€ì‹œëŸ½", "í˜•íƒœ": "ì•¡ìƒí˜•", "ì„±ë¶„": ["ì•„ì„¸íŠ¸ì•„ë¯¸ë…¸íŽœ"]},
        {"ì´ë¦„": "ì†ì½œíŽœì •", "í˜•íƒœ": "ì •ì œ ë° ìº¡ìŠí˜•", "ì„±ë¶„": ["ì´ë¶€í”„ë¡œíŽœ", "ì¹´íŽ˜ì¸"]}
    ],
    "ê·¼ìœ¡í†µ": [
        {"ì´ë¦„": "íŽœìž˜íì •", "í˜•íƒœ": "ì •ì œ ë° ìº¡ìŠí˜•", "ì„±ë¶„": ["ì´ë¶€í”„ë¡œíŽœ", "ì¹´íŽ˜ì¸"]},
        {"ì´ë¦„": "íƒ€ì´ë ˆë†€ì‹œëŸ½", "í˜•íƒœ": "ì•¡ìƒí˜•", "ì„±ë¶„": ["ì•„ì„¸íŠ¸ì•„ë¯¸ë…¸íŽœ"]},
        {"ì´ë¦„": "ë¶€ë£¨íŽœì •", "í˜•íƒœ": "ì •ì œ ë° ìº¡ìŠí˜•", "ì„±ë¶„": ["ì´ë¶€í”„ë¡œíŽœ"]}
    ],
    "ê´€ì ˆí†µ": [
        {"ì´ë¦„": "íƒ€ì„¸ë†€ì •", "í˜•íƒœ": "ì •ì œ ë° ìº¡ìŠí˜•", "ì„±ë¶„": ["ì•„ì„¸íŠ¸ì•„ë¯¸ë…¸íŽœ"]},
        {"ì´ë¦„": "ì„¸í† íŽœì‹œëŸ½", "í˜•íƒœ": "ì•¡ìƒí˜•", "ì„±ë¶„": ["ì•„ì„¸íŠ¸ì•„ë¯¸ë…¸íŽœ"]},
        {"ì´ë¦„": "ë¶€ë£¨íŽœì‹œëŸ½", "í˜•íƒœ": "ì•¡ìƒí˜•", "ì„±ë¶„": ["ì´ë¶€í”„ë¡œíŽœ"]}
    ],
    "ì¹˜í†µ": [
        {"ì´ë¦„": "íƒ€ì´ë ˆë†€ì •", "í˜•íƒœ": "ì •ì œ ë° ìº¡ìŠí˜•", "ì„±ë¶„": ["ì•„ì„¸íŠ¸ì•„ë¯¸ë…¸íŽœ"]},
        {"ì´ë¦„": "ë§¥ì‹œë¶€íŽœì‹œëŸ½", "í˜•íƒœ": "ì•¡ìƒí˜•", "ì„±ë¶„": ["ë±ì‹œë¶€í”„ë¡œíŽœ"]},
        {"ì´ë¦„": "ê²Œë³´ë¦°ì •", "í˜•íƒœ": "ì •ì œ ë° ìº¡ìŠí˜•", "ì„±ë¶„": ["ì´ë¶€í”„ë¡œíŽœ", "ì¹´íŽ˜ì¸"]}
    ]
}
avoid_ingredients = {
    "ì²œì‹": ["ì´ë¶€í”„ë¡œíŽœ"],
    "ì•Œë ˆë¥´ê¸°": ["ì¹´íŽ˜ì¸", "ì´ë¶€í”„ë¡œíŽœ"],
    "ì¡¸ìŒ": ["í•­ížˆìŠ¤íƒ€ë¯¼"],
    "ìœ„ìž¥ ìž¥ì• ": ["ì´ë¶€í”„ë¡œíŽœ"]
}

def main():
    st.title("ðŸ’ŠPainkiller Adviser")

    symptom = st.selectbox("1. ì¦ìƒì„ ì„ íƒí•˜ì„¸ìš”:", list(medicine_db.keys()))
    selected_criteria = st.multiselect("2. ê³ ë ¤ì‚¬í•­ì„ ì„ íƒí•˜ì„¸ìš”:", list(avoid_ingredients.keys()))
    form = st.radio("3. ì•½ í˜•íƒœë¥¼ ì„ íƒí•˜ì„¸ìš”:", ["ì •ì œ ë° ìº¡ìŠí˜•", "ì•¡ìƒí˜•"])

    avoid_set = set()
    for c in selected_criteria:
        avoid_set.update(avoid_ingredients.get(c, []))

    st.markdown(f"### ðŸš«í”¼í•´ì•¼ í•  ì„±ë¶„: {', '.join(avoid_set) if avoid_set else 'ì—†ìŒ'}")

    candidates = medicine_db.get(symptom, [])
    recommended = []
    for med in candidates:
        if med["í˜•íƒœ"] == form and not any(ingredient in avoid_set for ingredient in med["ì„±ë¶„"]):
            recommended.append(med["ì´ë¦„"])

    if recommended:
        st.markdown("### âœ…ì¶”ì²œ ì•½ë¬¼:")
        for name in recommended:
            st.write(f"- {name}")
    else:
        st.warning("ì¡°ê±´ì— ë§žëŠ” ì•½ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤. ì•½ì‚¬ì™€ ìƒë‹´ì„ ê¶Œìž¥í•©ë‹ˆë‹¤.")

# í•˜ë‹¨ ë§í¬ ì¶”ê°€
    st.markdown("---")
    st.markdown("ðŸ“®ê°„ëžµí•œ ì„¤ë¬¸ -> [https://forms.gle/N8vsQsLsfscxJedo8]")

if __name__ == "__main__":
    main()
